<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.2.1">Jekyll</generator><link href="https://aem.design/feed.xml" rel="self" type="application/atom+xml" /><link href="https://aem.design/" rel="alternate" type="text/html" /><updated>2022-01-19T14:08:16+11:00</updated><id>https://aem.design/feed.xml</id><title type="html">AEM.Design</title><subtitle>An amazing website.</subtitle><author><name>{&quot;name&quot;=&gt;nil, &quot;avatar&quot;=&gt;nil, &quot;bio&quot;=&gt;nil, &quot;location&quot;=&gt;nil, &quot;email&quot;=&gt;nil, &quot;links&quot;=&gt;[{&quot;label&quot;=&gt;&quot;Email&quot;, &quot;icon&quot;=&gt;&quot;fas fa-fw fa-envelope-square&quot;}, {&quot;label&quot;=&gt;&quot;Website&quot;, &quot;icon&quot;=&gt;&quot;fas fa-fw fa-link&quot;}, {&quot;label&quot;=&gt;&quot;Twitter&quot;, &quot;icon&quot;=&gt;&quot;fab fa-fw fa-twitter-square&quot;}, {&quot;label&quot;=&gt;&quot;Facebook&quot;, &quot;icon&quot;=&gt;&quot;fab fa-fw fa-facebook-square&quot;}, {&quot;label&quot;=&gt;&quot;GitHub&quot;, &quot;icon&quot;=&gt;&quot;fab fa-fw fa-github&quot;}, {&quot;label&quot;=&gt;&quot;Instagram&quot;, &quot;icon&quot;=&gt;&quot;fab fa-fw fa-instagram&quot;}]}</name></author><entry><title type="html">How to add property and author a component programmatically?</title><link href="https://aem.design/blog/2022/01/19/how-to-add-property-and-author-a-component-programmatically" rel="alternate" type="text/html" title="How to add property and author a component programmatically?" /><published>2022-01-19T00:00:00+11:00</published><updated>2022-01-19T14:03:53+11:00</updated><id>https://aem.design/blog/2022/01/19/how-to-add-property-and-author-a-component-programmatically</id><content type="html" xml:base="https://aem.design/blog/2022/01/19/how-to-add-property-and-author-a-component-programmatically"><![CDATA[<h2 id="updatating-aem-content-programmatically">Updatating AEM Content programmatically?</h2>

<p>By far the easiest method of updating your AEM content programmatically is to use <a href="https://adobe-consulting-services.github.io/acs-aem-commons/features/on-deploy-scripts/index.html">ACS On-Deploy Script</a></p>

<p>To do this you will need these java files</p>
<ul>
  <li><a href="#1-ondeployscriptproviderimpljava">OnDeployScriptProviderImpl.java</a> - which will load your Script <code class="language-plaintext highlighter-rouge">UpdateNodeAttibutes</code>, read more about this in the docs.</li>
  <li><a href="#2-updatenodeattibutesjava">UpdateNodeAttibutes.java</a> - which will update your data..</li>
</ul>

<p>Here is starting content for your files…</p>

<h3 id="1-ondeployscriptproviderimpljava">1. OnDeployScriptProviderImpl.java</h3>

<p>Location: <code class="language-plaintext highlighter-rouge">design\aem\ondeploy\OnDeployScriptProviderImpl.java</code></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">design.aem.ondeploy</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.adobe.acs.commons.ondeploy.OnDeployScriptProvider</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.adobe.acs.commons.ondeploy.scripts.OnDeployScript</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">design.aem.ondeploy.scripts.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.felix.scr.annotations.Properties</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.felix.scr.annotations.Property</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.felix.scr.annotations.Service</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.osgi.service.component.annotations.Component</span><span class="o">;</span>

<span class="nd">@Component</span><span class="o">(</span><span class="n">immediate</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="nd">@Service</span>
<span class="nd">@Properties</span><span class="o">({</span>
        <span class="nd">@Property</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"service.description"</span><span class="o">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s">"Developer service that identifies code scripts to execute upon deployment"</span><span class="o">)</span>
<span class="o">})</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OnDeployScriptProviderImpl</span> <span class="kd">implements</span> <span class="nc">OnDeployScriptProvider</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">OnDeployScript</span><span class="o">&gt;</span> <span class="nf">getScripts</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span>
            <span class="k">new</span> <span class="nf">UpdateNodeAttibutes</span><span class="o">()</span>
        <span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="2-updatenodeattibutesjava">2. UpdateNodeAttibutes.java</h3>

<p>Location: <code class="language-plaintext highlighter-rouge">design\aem\ondeploy\scripts\UpdateNodeAttibutes.java</code></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">design.aem.ondeploy.scripts</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.adobe.acs.commons.ondeploy.scripts.OnDeployScript</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.adobe.acs.commons.ondeploy.scripts.OnDeployScriptBase</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.day.cq.search.PredicateGroup</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.day.cq.search.Query</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.day.cq.search.QueryBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.day.cq.search.result.Hit</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.day.cq.search.result.SearchResult</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.day.cq.wcm.api.Page</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Iterator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.jcr.Node</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.jcr.RepositoryException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.jcr.Session</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.commons.lang3.StringUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.sling.api.resource.ModifiableValueMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.sling.api.resource.Resource</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.sling.api.resource.ResourceResolver</span><span class="o">;</span>


<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UpdateNodeAttibutes</span> <span class="kd">extends</span> <span class="nc">OnDeployScriptBase</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">CONTENT_ROOT_PATH</span> <span class="o">=</span> <span class="s">"/content/"</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">String</span><span class="o">&gt;</span> <span class="no">RENAME_ATTRIBUTES</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;()</span> <span class="o">;</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">String</span><span class="o">&gt;</span> <span class="no">ADD_ATTRIBUTES</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;()</span> <span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">execute</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>

        <span class="nc">QueryBuilder</span> <span class="n">queryBuilder</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getResourceResolver</span><span class="o">().</span><span class="na">adaptTo</span><span class="o">(</span><span class="nc">QueryBuilder</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="c1">// predicates for properties we are looking for.</span>
        <span class="c1">// more info on how to make these https://github.com/paulrohrbeck/aem-links/blob/master/querybuilder_cheatsheet.md</span>
        <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">param</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>

        <span class="n">param</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"path"</span><span class="o">,</span> <span class="no">CONTENT_ROOT_PATH</span><span class="o">);</span>
        <span class="n">param</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"p.limit"</span><span class="o">,</span> <span class="s">"-1"</span><span class="o">);</span>

        <span class="kt">long</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
        <span class="k">for</span><span class="o">(</span><span class="nc">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="o">:</span> <span class="no">RENAME_ATTRIBUTES</span><span class="o">.</span><span class="na">entrySet</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">();</span>

            <span class="n">param</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"group."</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s">"_property"</span><span class="o">,</span> <span class="s">"@"</span> <span class="o">+</span> <span class="n">key</span><span class="o">);</span>
            <span class="n">param</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"group."</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s">"_property.value"</span><span class="o">,</span> <span class="s">"true"</span><span class="o">);</span>
            <span class="n">param</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"group."</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s">"_property.operation"</span><span class="o">,</span> <span class="s">"exists"</span><span class="o">);</span>
            <span class="n">i</span><span class="o">++;</span>

        <span class="o">}</span>

        <span class="n">param</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"group.p.or"</span><span class="o">,</span> <span class="s">"true"</span><span class="o">);</span>

        <span class="c1">// this will return a list of all pages that have any of properties we need</span>
        <span class="nc">Query</span> <span class="n">query</span> <span class="o">=</span> <span class="n">queryBuilder</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span>
                <span class="nc">PredicateGroup</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">param</span><span class="o">),</span>
                <span class="k">this</span><span class="o">.</span><span class="na">getResourceResolver</span><span class="o">().</span><span class="na">adaptTo</span><span class="o">(</span><span class="nc">Session</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="o">);</span>

        <span class="nc">SearchResult</span> <span class="n">result</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">getResult</span><span class="o">();</span>

        <span class="kt">boolean</span> <span class="n">migrationError</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

        <span class="c1">// walk the query result</span>
        <span class="k">for</span> <span class="o">(</span><span class="kd">final</span> <span class="nc">Hit</span> <span class="n">hit</span> <span class="o">:</span> <span class="n">result</span><span class="o">.</span><span class="na">getHits</span><span class="o">())</span> <span class="o">{</span>

            <span class="nc">Resource</span> <span class="n">resultResource</span> <span class="o">=</span> <span class="n">hit</span><span class="o">.</span><span class="na">getResource</span><span class="o">();</span>

            <span class="k">if</span> <span class="o">(</span><span class="n">resultResource</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>

                <span class="nc">ModifiableValueMap</span> <span class="n">resourceProps</span> <span class="o">=</span> <span class="n">resultResource</span><span class="o">.</span><span class="na">adaptTo</span><span class="o">(</span><span class="nc">ModifiableValueMap</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

                <span class="k">try</span> <span class="o">{</span>
                    <span class="c1">// walk though all nodes that need to be renamed</span>
                    <span class="k">for</span><span class="o">(</span><span class="nc">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="o">:</span> <span class="no">RENAME_ATTRIBUTES</span><span class="o">.</span><span class="na">entrySet</span><span class="o">())</span> <span class="o">{</span>
                        <span class="nc">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">();</span>
                        <span class="nc">String</span> <span class="n">newKey</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>

                        <span class="c1">// if node map contains attribute create a new entry.</span>
                        <span class="k">if</span> <span class="o">(</span><span class="n">resourceProps</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">key</span><span class="o">))</span> <span class="o">{</span>
                            <span class="c1">// add value with new key</span>
                            <span class="n">resourceProps</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">newKey</span><span class="o">,</span><span class="n">resourceProps</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">));</span>
                            <span class="c1">// remove old key and value</span>
                            <span class="n">resourceProps</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
                        <span class="o">}</span>
                    
                    <span class="o">}</span>
                    
                    <span class="k">for</span><span class="o">(</span><span class="nc">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="o">:</span> <span class="no">ADD_ATTRIBUTES</span><span class="o">.</span><span class="na">entrySet</span><span class="o">())</span> <span class="o">{</span>
                        <span class="nc">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">();</span>
                        <span class="nc">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>

                        <span class="c1">// if node map contains attribute create a new entry.</span>
                        <span class="k">if</span> <span class="o">(</span><span class="n">resourceProps</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">key</span><span class="o">))</span> <span class="o">{</span>
                            <span class="c1">// add new key and value</span>
                            <span class="n">resourceProps</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span><span class="n">value</span><span class="o">);</span>
                        <span class="o">}</span>
                    
                    <span class="o">}</span>

                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">migrationError</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span> 
                    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"Could not complete migration."</span><span class="o">);</span>
                <span class="o">}</span>

                
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">if</span> <span class="o">(!</span><span class="n">migrationError</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">getSession</span><span class="o">().</span><span class="na">save</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<p>Update <code class="language-plaintext highlighter-rouge">RENAME_ATTRIBUTES</code> and <code class="language-plaintext highlighter-rouge">ADD_ATTRIBUTES</code> maps for desired oucome, good luck and have fun!</p>

<h3 id="thank-you">Thank you</h3>

<p>If you would like to contribute or fork the code, you can get it on GitHub <a href="https://github.com/aem-design">https://github.com/aem-design</a> and through Maven central.</p>

<p>Don’t forget to tell your friends.</p>]]></content><author><name>Max Barrass</name><email>max@aem.design</email><uri>http://maxbarrass.com</uri></author><category term="blog" /><category term="aem" /><category term="ondeploy" /><category term="acs" /><category term="data" /><category term="patterns" /><summary type="html"><![CDATA[ACS On-Deploy is the answer!]]></summary></entry><entry><title type="html">SPA, Headless, Widgets and AEM?</title><link href="https://aem.design/blog/2021/09/10/spa-headless-widgets-and-aem" rel="alternate" type="text/html" title="SPA, Headless, Widgets and AEM?" /><published>2021-09-10T00:00:00+10:00</published><updated>2021-09-10T17:35:40+10:00</updated><id>https://aem.design/blog/2021/09/10/spa-widgets-and-aem</id><content type="html" xml:base="https://aem.design/blog/2021/09/10/spa-headless-widgets-and-aem"><![CDATA[<p>There are many ways to build the web; most of the ways can be implemented in AEM, which one works best is going to depend on your authors. What the authors are willing to author, how involved do they get with content, and how involved do they want to get with crafting experiences? Once you answer, these questions the solution will pop out. The following should provide an overview of available options and arm you with information to make a choice.</p>

<h2 id="spa-headless-add-widgets-patterns-in-aem">SPA, Headless add Widgets patterns in AEM</h2>

<p>Before we starte here is a context of each term</p>

<p>SPA - single page application an alternative to a multi-page website.
SPA Editor - AEM native editor for SPA’s
Headless - a pattern where you leverage API or GrapgQL to get data from server
Widget - a component of a web page with clientside experience, it has basic HTML, and javascript turns into the interactive experience when loaded.</p>

<p>Now we can extrapolate these in relation to AEM. Here is a summary of patterns of implementing single-page and multi-page experience in AEM. In a lot of AEM implementations, you will find that all of these methods would have been utilised over time.</p>

<p>SPA - is a standalone application hosted externally to AEM, managed by developers, potential config by authors through content; can be headless.
SPA in a Page - provides a method of host SPA application in a page, giving the ability to place SPA’s in different parts of the site; developer-focused, SPA has a dedicated component with possible authoring inputs; can be headless.
SPA Editor - native ability to create SPA’s in AEM, allow full authoring of application; native components; can be headless.
Page - a native way to create multi-page experiences, allow full authoring of pages, full content reuse and ability to use any components needed; a primary way of creating content for the web.
Widgets in Page - small targeted components that are added to pages to create experiences; provides a way to create rich experiences that could be hard to author; can be headless.</p>

<p>Here is this information in a table.</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th style="text-align: center"> </th>
      <th style="text-align: center">Hosting</th>
      <th style="text-align: center"> </th>
      <th style="text-align: center">Page Experience</th>
      <th style="text-align: center"> </th>
      <th style="text-align: center">Focus</th>
      <th style="text-align: center"> </th>
      <th style="text-align: center">Content Usage</th>
      <th style="text-align: center"> </th>
      <th style="text-align: center"> </th>
      <th style="text-align: center"> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Pattern</td>
      <td style="text-align: center">Headless</td>
      <td style="text-align: center">External</td>
      <td style="text-align: center">Internal</td>
      <td style="text-align: center">Single Page</td>
      <td style="text-align: center">Multi-Page</td>
      <td style="text-align: center">Authoring</td>
      <td style="text-align: center">Developer</td>
      <td style="text-align: center">API</td>
      <td style="text-align: center">Page</td>
      <td style="text-align: center">Tags</td>
      <td style="text-align: center">Assets</td>
    </tr>
    <tr>
      <td>SPA</td>
      <td style="text-align: center">x</td>
      <td style="text-align: center">x</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">x</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">x</td>
      <td style="text-align: center">x</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
    </tr>
    <tr>
      <td>SPA in Page</td>
      <td style="text-align: center">x</td>
      <td style="text-align: center">x</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">x</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">x</td>
      <td style="text-align: center">x</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
    </tr>
    <tr>
      <td>SPA Editor</td>
      <td style="text-align: center">x</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">x</td>
      <td style="text-align: center">x</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">x</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">x</td>
      <td style="text-align: center">x</td>
      <td style="text-align: center">x</td>
      <td style="text-align: center">x</td>
    </tr>
    <tr>
      <td>Page</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">x</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">x</td>
      <td style="text-align: center">x</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">x</td>
      <td style="text-align: center">x</td>
      <td style="text-align: center">x</td>
    </tr>
    <tr>
      <td>Widget in Page</td>
      <td style="text-align: center">x</td>
      <td style="text-align: center">x</td>
      <td style="text-align: center">x</td>
      <td style="text-align: center">x</td>
      <td style="text-align: center">x</td>
      <td style="text-align: center">x</td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">x</td>
      <td style="text-align: center">x</td>
      <td style="text-align: center">x</td>
      <td style="text-align: center">x</td>
    </tr>
  </tbody>
</table>

<p>Adding a Design Language System into the mix would also add another level of complexity as SPA, and native Web will have different Design Language primarily because native AEM components can have Styles applied to them by authors, and SPA would have a more focused and controlled set of settings.</p>

<h3 id="conclusion">Conclusion</h3>

<p>Focussing on AEM Authoring experience will always be beneficial as it will allow more people to help to grow experience. Having more eyes and hands helping to build the experience is always a good thing.</p>

<p>If you are must have a developer-centric experience and use AEM as a content repository, you can do it but you will be missing out on a lot of benefits that you would need to invent from sratch.</p>

<p>Using AEM SPA Editor will allow opening your experience building to authors so that they can help in any way they can. If you just have developers doing the authoring, then you will also missout on valuable input, and chances are you will rever to the vanila SPA pattern.</p>

<p>Going down the Widgets in a Page will give you the biggest impact as you can leverage all of the content authoring patterns and content services available in AEM. This will allow you to integrate widgets into existing pages, allow you to target them easily and importantly, all of this will be done by authors.</p>

<p>Obviously, all other patterns can be developed to the same level of maturity given appropriate time and effort.</p>

<h2 id="background">Background</h2>

<p>Here is the background information on building blocks that are used in SPA patterns.</p>

<h3 id="web-experiences">Web Experiences</h3>

<p>There are many ways to make great experiences for the web. In the end HTML and CSS is what all experiences are made of and its the details of how the developers choose to implement those experiences that varries. Traditional methods of we dev are either plain HTML pages or Single Page Application’s (SPA’s).</p>

<p>Plain HTML approach means that you develop multi-page experiences where a user is navigating a network of related pages. It’s a long term play, and you leverage a lot of technical and taxonomy tools to help you to play this out over a long period of time.</p>

<p><img src="/assets/diagrams/01-aem-spa-plain-web.png" alt="Plain Web" /></p>

<p>Single Page Applications or SPA’s is another approach that focuses all of the experiences into one page. This means that user does not navigate pages as such, they are confined to one page, and they navigate experience as its laid-out by the SPA, SPA uses traditional API’s or GraphQL to gather content it needs.</p>

<p><img src="/assets/diagrams/03-aem-spa-api-client-side.png" alt="SPA API" /></p>

<h3 id="aem-native-apis">AEM native API’s</h3>

<p>AEM technical strength is in the flexibility of content, content architecture and ability to render content in place in different ways. You can store content in AEM in anyway you want, structure it to make logical sense and retrieve it either with native API, GraphQL or custom API you need.</p>

<p>In AEM, you can store some content into a location <code class="language-plaintext highlighter-rouge">/content/page</code> then request its HTML representation <code class="language-plaintext highlighter-rouge">/content/page.html</code>, then request its XML representation <code class="language-plaintext highlighter-rouge">/content/page.xml</code>, then request its JSON representation <code class="language-plaintext highlighter-rouge">/content/page.tidy.5.json</code>, then request its Image representation <code class="language-plaintext highlighter-rouge">/content/page.thumbnail.png</code> and on and on.</p>

<p>AEM has a method for adding these renderers (html, json, xml, thubnail.png) that enable you to read content from anywhere and how you want it, essentially allowing the whole content repository to act as an API source, and you can read different bits of different content is many ways depending on your need.</p>

<p>AEM has a number of content experiences Content Fragments and Models, Experience Fragments, Tags and Sling API that allow you to get content from AEM. Additionally, ACS has several services that further complement OOTB functionality.</p>

<h3 id="aggregation-api">Aggregation API</h3>

<p>When it comes to the traditional API approach, the aim it funnels all of the calls into one area, one “service” that handles a request for that content. You typically should have an API gateway to ensure you do not flood your backend service and you would have a number API returning either atomic data or aggregated set of data.</p>

<p><img src="/assets/diagrams/04-aem-spa-api-client-side-aggregation.png" alt="Aggregation Headless Client Side" /></p>

<p>Aggregation of API’s is a pattern for gathering data from different API’s and presenting it in one package to the consumer. This pattern can be implemented both on the client and server-side. GraphQL essentially provides a server-side and client-side aggregation in one; you can get atomic data and aggregate as well with one API.</p>

<p><img src="/assets/diagrams/05-aem-spa-api-server-side-aggregation.png" alt="Aggregation Headless Server Side" /></p>

<p>GraphQL API approach allows you to get the same data as traditional API but potentially at the client-side. This obviously has a lot of perceived flexibility as the structure of API is moved up the stack and managed by the UI layer, and the same methods should be used to protect the backend.</p>

<h3 id="headless-aem">Headless AEM</h3>

<p>Headless is a method of using AEM as a source of data, and the primary way of achieving this is by using API and GraphQL for getting data out of AEM. This pattern can be used in any SPA and Widget approach but does make AEM more developer-focused.</p>

<p><img src="/assets/diagrams/06-aem-spa-headless.png" alt="Headless" /></p>

<h4 id="widgets-in-aem">Widgets in AEM</h4>

<p>Widgets are a way of creating AEM authoring components that have rich client-side presentations. This pattern allows full authoring experiences and all of the API patterns to be used.</p>

<p><img src="/assets/diagrams/02-aem-spa-api-widgets.png" alt="Widgets" /></p>

<h3 id="thank-you">Thank you</h3>

<p>Please checkout the docker hub <a href="https://hub.docker.com/r/aemdesign/aem">aemdesign/aem</a> for latest AEM SDK images.</p>

<p>If you would like to contribute or fork the code, you can get it on GitHub <a href="https://github.com/aem-design">https://github.com/aem-design</a> and through Maven central.</p>

<p>Don’t forget to tell your friends.</p>]]></content><author><name>Max Barrass</name><email>max@aem.design</email><uri>http://maxbarrass.com</uri></author><category term="blog" /><category term="aem" /><category term="spa" /><category term="headless" /><category term="widgets" /><category term="knowledge" /><category term="patterns" /><summary type="html"><![CDATA[When to use these and what they achieve?]]></summary></entry><entry><title type="html">AEM Akamai Cache flush Agent 😍</title><link href="https://aem.design/blog/2021/04/25/creating-akamai-flush-agent" rel="alternate" type="text/html" title="AEM Akamai Cache flush Agent 😍" /><published>2021-04-25T00:00:00+10:00</published><updated>2021-09-21T16:35:10+10:00</updated><id>https://aem.design/blog/2021/04/25/creating-akamai-flush-agent</id><content type="html" xml:base="https://aem.design/blog/2021/04/25/creating-akamai-flush-agent"><![CDATA[<h2 id="introduction">Introduction</h2>

<p>After the first hit to the page in aem and HTML response received for first time from publish instance will get cached on Akamai level.</p>

<p>Subsequent request to the same page will be served from the cached content in Akamai rather than hitting dispatcher / publisher.</p>

<p>Anytime did you struggled to get the latest HTML from publisher instead of Akamai cache?</p>

<p><strong><em>Well we did!!!</em></strong></p>

<h2 id="what-we-have-done">What we have done</h2>

<p>We have worked on AEM replication agent for flushing Akamai cache whenever page gets published.</p>

<p>So, after author change a page content and publish it our Akamai cache flush agent configured on publisher environment will pick that page and request to akamai for clearing cache. 
So that user of that page will get the latest content instead of cached old content from Akamai.</p>

<p>It is all automated, we don’t need to clear the Akamai cache when new product goes live to prod.</p>

<p>We don’t ask DevOps to clear Akamai cache so customers will see latest page. Lets save their 1-2 min(s) time whenever new product launch.</p>

<h2 id="where-you-can-find-the-code">Where you can find the code</h2>

<p><a href="https://github.com/aem-design/aemdesign-aem-core/tree/master/aemdesign-aem-common/src/main/content/jcr_root/apps/aemdesign/components/replication/akamai">Akamai Cache Flush Agent</a></p>

<p><a href="https://github.com/aem-design/aemdesign-aem-core/blob/master/aemdesign-aem-services/src/main/java/design/aem/transport/AkamaiTransportHandler.java">Akamai Transport Handler</a></p>

<h2 id="what-are-all-details-do-you-need-to-setup-flush-agent">What are all details do you need to setup flush agent</h2>

<ol>
  <li>akamaiDomain</li>
  <li>akamaiBaseUrl</li>
  <li>akamaiPurgeUrlPath</li>
  <li>clientToken</li>
  <li>clientAccessToken</li>
  <li>clientSecret</li>
</ol>

<p>If you think you don’t know these info’s or not sure from where you can get it? Ask devOps these information and say I got your back if you provide me these info 😍</p>

<h2 id="how-we-are-managing-the-secrets">How we are managing the secrets</h2>

<p>After getting the above information from you, we are encrypting keys using AEM’s crypto support and storing it on AEM so you are safe with your secrets.
While we use it for making the POST call from Transport Handler we will decrypt the keys and use it.</p>

<p>Also while making a POST call to Akamai servers we are using HMAC_SHA_256 to protect the data.</p>

<p>Make sure you are configuring the Akamai cache flush agent on each environment separately</p>

<h2 id="how-to-configure-akamai-flush-agent-on-your-aem-author--publish-instance">How to configure Akamai flush agent on your AEM author / publish instance</h2>

<p>By Assuming you have installed aem design code into your local AEM.</p>

<h2 id="when-to-setup-on-author-and-when-to-setup-on-publish">When to setup on author and when to setup on publish</h2>

<p>Setup Akamai flush agent on AEM author instance only if you have akamai setup on author level as well. Mostly we will have Akamai setup for publish env.</p>

<p>Always setup Akamai flush agent on publish level so as soon as the page reaches publish instance our Akamai flush agent will go ahead and clear Akamai Cache.</p>

<h2 id="how-to-setup-akamai-flush-agent">How to setup Akamai flush agent</h2>

<p>Go to <a href="http://localhost:4502/miscadmin">miscadmin</a> and open replication/agents.author for author instance &amp; replication/agents.publish for publish instance</p>

<p>here I’m showing example of setting flush agent in author level same time you can set it in publisher as well.</p>

<p><img src="/assets/images/akamai-flush-agent/akamai-replication-miscadmin.png" alt="miscadmin" /></p>

<p>Click new from tool bar and you will see the Create Page dialog.</p>

<p><img src="/assets/images/akamai-flush-agent/akamai-create-agent.png" alt="create new agent" /></p>

<p>Select “Akamai Publishing Replication” and give your replication agent a name &amp; title.
Click on create and open the newly created agent on the list. (it will be the last entry on the list)
Click on Edit and provide the information required and click on Ok.</p>

<p><img src="/assets/images/akamai-flush-agent/akamai-settings-tab.png" alt="settings tab" /></p>

<p><img src="/assets/images/akamai-flush-agent/akamai-config-tab.png" alt="config_tab" /></p>

<p>You should be able to see the Akamai Flush Agent is On (green) and it will look for any replication events.</p>

<p><img src="/assets/images/akamai-flush-agent/akamai-enabled-agent.png" alt="success" /></p>

<p>Click on Test Connection link and make sure you have all the correct configurations.
You should see “Replication test succeeded”</p>

<h2 id="conclusion">Conclusion</h2>

<p>This component will save our time whenever we need to update the content in AEM pages.</p>

<p>Make sure you have set up the dispatcher flush agent as well so we can avoid content served from Dispatcher cache.</p>

<p>Feel free to reach out to us if you have any questions and don’t forget to tell your friends.</p>

<h3 id="thank-you">Thank you</h3>]]></content><author><name>Seenivasa Ragavan Soundar Rajan</name><email>mailtoragavan.be@gmail.com</email></author><category term="blog" /><category term="devops" /><category term="aem" /><category term="akamai" /><category term="knowledge" /><category term="sharing" /><summary type="html"><![CDATA[Why should we bother DevOps to clear Akamai Cache when you can do it yourself using flush agent]]></summary></entry><entry><title type="html">AEM SDK and JDK11</title><link href="https://aem.design/blog/2021/03/16/aem-sdk-jdk11" rel="alternate" type="text/html" title="AEM SDK and JDK11" /><published>2021-03-16T23:37:00+11:00</published><updated>2021-12-22T10:23:36+11:00</updated><id>https://aem.design/blog/2021/03/16/aem-sdk-jdk11</id><content type="html" xml:base="https://aem.design/blog/2021/03/16/aem-sdk-jdk11"><![CDATA[<p>Building on the previous work <a href="/blog/2019/07/01/docker-containers-everywhere">Docker Containers Everywhere</a>, <a href="/blog/2019/09/04/aem-and-docker😍😘">AEM and Docker 😍😘</a> and <a href="/blog/2019/08/30/docker-aem-bundle">Docker AEM Bundle</a> its time to bring AEM SDK and JDK11 into life!</p>

<p>If you take a look <a href="https://hub.docker.com/r/aemdesign/aem">docker hub</a> and <a href="https://github.com/aem-design/docker-aem">docker-aem</a> branches you will find a couple of new additions that you will find helpful.</p>

<p>JDK11 version of AEM 6.5 and AEM SDK version is now ready for use!</p>

<h3 id="running-aem-jdk-11-in-docker">Running AEM JDK 11 in Docker</h3>

<p>To start author AEM 6.5 with SP10 on JDK11 run the following:</p>

<div class="code-copy-header">
  <button class="copy-code-button" aria-label="Copy code to clipboard"></button>
</div>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">docker</span><span class="w"> </span><span class="nx">run</span><span class="w"> </span><span class="nt">--name</span><span class="w"> </span><span class="nx">author655</span><span class="w"> </span><span class="nt">-e</span><span class="w"> </span><span class="s2">"TZ=Australia/Sydney"</span><span class="w"> </span><span class="nt">-e</span><span class="w"> </span><span class="s2">"AEM_RUNMODE=-Dsling.run.modes=author,crx3,crx3tar,forms,localdev"</span><span class="w"> </span><span class="nt">-e</span><span class="w"> </span><span class="s2">"AEM_JVM_OPTS=-server -Xms248m -Xmx1524m -XX:MaxDirectMemorySize=256M -XX:+CMSClassUnloadingEnabled -Djava.awt.headless=true -Dorg.apache.felix.http.host=0.0.0.0 -Xdebug -Xrunjdwp:transport=dt_socket,server=y,address=58242,suspend=n -XX:+UseParallelGC --add-opens=java.desktop/com.sun.imageio.plugins.jpeg=ALL-UNNAMED --add-opens=java.base/sun.net.www.protocol.jrt=ALL-UNNAMED --add-opens=java.naming/javax.naming.spi=ALL-UNNAMED --add-opens=java.xml/com.sun.org.apache.xerces.internal.dom=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/jdk.internal.loader=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED -Dnashorn.args=--no-deprecation-warning"</span><span class="w"> </span><span class="nt">-p4502</span><span class="p">:</span><span class="nx">8080</span><span class="w"> </span><span class="nt">-p30303</span><span class="p">:</span><span class="nx">58242</span><span class="w"> </span><span class="nt">-d</span><span class="w"> </span><span class="nx">aemdesign/aem:6.5.10.0-jdk11</span><span class="w">
</span></code></pre></div></div>

<p>To start author AEM SDK version 2021.10.5958 run the following:</p>

<div class="code-copy-header">
  <button class="copy-code-button" aria-label="Copy code to clipboard"></button>
</div>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">docker</span><span class="w"> </span><span class="nx">run</span><span class="w"> </span><span class="nt">--name</span><span class="w"> </span><span class="nx">authorsdk2021105958</span><span class="w"> </span><span class="nt">-e</span><span class="w"> </span><span class="s2">"TZ=Australia/Sydney"</span><span class="w"> </span><span class="nt">-e</span><span class="w"> </span><span class="s2">"AEM_RUNMODE=-Dsling.run.modes=author,crx3,crx3tar,forms,localdev"</span><span class="w"> </span><span class="nt">-e</span><span class="w"> </span><span class="s2">"AEM_JVM_OPTS=-server -Xms248m -Xmx1524m -XX:MaxDirectMemorySize=256M -XX:+CMSClassUnloadingEnabled -Djava.awt.headless=true -Dorg.apache.felix.http.host=0.0.0.0 -Xdebug -Xrunjdwp:transport=dt_socket,server=y,address=58242,suspend=n -XX:+UseParallelGC --add-opens=java.desktop/com.sun.imageio.plugins.jpeg=ALL-UNNAMED --add-opens=java.base/sun.net.www.protocol.jrt=ALL-UNNAMED --add-opens=java.naming/javax.naming.spi=ALL-UNNAMED --add-opens=java.xml/com.sun.org.apache.xerces.internal.dom=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/jdk.internal.loader=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED -Dnashorn.args=--no-deprecation-warning"</span><span class="w"> </span><span class="nt">-p4502</span><span class="p">:</span><span class="nx">8080</span><span class="w"> </span><span class="nt">-p30303</span><span class="p">:</span><span class="nx">58242</span><span class="w"> </span><span class="nt">-d</span><span class="w"> </span><span class="nx">aemdesign/aem:sdk-2021.10.5958</span><span class="w">
</span></code></pre></div></div>

<p>To make all this possible following Docker image chain has been updated:</p>

<ul>
  <li><a href="https://github.com/aem-design/docker-aem/tree/jdk11">aemdesign/aem:jdk11</a> - AEM Quickstart content
    <ul>
      <li><a href="https://github.com/aem-design/docker-aem-base/tree/jdk11">aemdesign/aem-base:jdk11</a> - AEM linux dependencies
        <ul>
          <li><a href="https://github.com/aem-design/docker-java-ffmpeg/tree/jdk11">aemdesign/java-ffmpeg:jdk11</a> - provides ImageMagic and FFMpeg libraries
            <ul>
              <li><a href="https://github.com/aem-design/docker-oracle-jdk/tree/jdk11">aemdesign/oracle-jdk:jdk11</a> - provides a an oracle jdk
                <ul>
                  <li><a href="https://github.com/aem-design/docker-centos-tini/tree/centos8">aemdesign/centos-tini:centos8</a> - provides a base for all java apps</li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>In addition to these pipelines have been updated to allow Docker Image squash experimental option to ensure all images have the smallest amount of layers.</p>

<p>Additionally, centos build pack has been updated to JDK 11 and Centos 8 with all the swiss army knife tools one expects.</p>

<ul>
  <li><a href="https://github.com/aem-design/docker-centos-java-buildpack/tree/jdk11">aemdesign/centos-java-buildpack:jdk11</a></li>
</ul>

<h3 id="thank-you">Thank you</h3>

<p>Please checkout the docker hub <a href="https://hub.docker.com/r/aemdesign/aem">aemdesign/aem</a> for further details.</p>

<p>If you would like to contribute or fork the code, you can get it on GitHub <a href="https://github.com/aem-design">https://github.com/aem-design</a>.</p>

<p>Don’t forget to tell your friends.</p>]]></content><author><name>Max Barrass</name><email>max@aem.design</email><uri>http://maxbarrass.com</uri></author><category term="blog" /><category term="devops" /><category term="aem" /><category term="docker" /><summary type="html"><![CDATA[Building on the previous work Docker Containers Everywhere, AEM and Docker 😍😘 and Docker AEM Bundle its time to bring AEM SDK and JDK11 into life!]]></summary></entry><entry><title type="html">Automation Testing For AEM Dialogs</title><link href="https://aem.design/blog/2021/01/21/automation-testing-for-aem-dialogs" rel="alternate" type="text/html" title="Automation Testing For AEM Dialogs" /><published>2021-01-21T00:37:00+11:00</published><updated>2021-04-27T02:36:37+10:00</updated><id>https://aem.design/blog/2021/01/21/automation-testing-for-aem-dialogs</id><content type="html" xml:base="https://aem.design/blog/2021/01/21/automation-testing-for-aem-dialogs"><![CDATA[<p>Automation testing is an absolute mandatory and covered in <a href="/blog/2017/06/28/automation-testing">Automation Testing and Human Reporting</a> and demonstrates a viable, usable AEM Automated Testing approach and does not make the automated testing suite a development only agenda.</p>

<p>Over the last few years, AEM Automation Testing for AEM Dialog has been getting more focus, and I have been asked by many how to do this easily. The current approach leverages existing AEM Editor experience to view and load dialogs so that they can be tested. One of the improvements that have been asked can that be made faster so that actual pages do not require loading, so that spec execution speed improves.</p>

<p>AEM being a gem of capabilities has this covered, and with little effort, we can leverage this to really create powerful specs that test component dialogues as a user would use them. The key to this is understanding how AEM loads component dialogs and the data they represent. Fortunately this pattern very simple using sling.</p>

<ul>
  <li>First you need a path to a dialog (<code class="language-plaintext highlighter-rouge">/apps/aemdesign/components/details/generic-details/v1/generic-details/_cq_dialog.html</code>) this path is a component that takes as a parameter as a path to the component dialog should show and update.</li>
  <li>Second you need a content path (<code class="language-plaintext highlighter-rouge">/content/aemdesign-showcase/au/en/component/details/generic-details/jcr:content/article/par/contentblock7/par/genericdetails</code>) which dialog should update. This is simply any path that dialog will use for reading and wirting.</li>
  <li>Third you combine these into a url you can use for automation <code class="language-plaintext highlighter-rouge">http://localhost:4512/mnt/override/apps/aemdesign/components/details/generic-details/v1/generic-details/_cq_dialog.html/content/aemdesign-showcase/au/en/component/details/generic-details/jcr:content/article/par/contentblock7/par/genericdetails</code></li>
</ul>

<p>And that’s it! Now you can write any tests around this URL. Taking this knowledge a spec can be updated to allow testing AEM Dialog with ease and without loading whole pages!</p>

<p>Here is a reference AEM component dialog spec that tests of the tabs that appear on the component have the right content appearing. This is done simply by taking a screenshot of the dialog’s page.</p>

<div class="language-groovy highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">specs.component.details.genericdetails</span>

<span class="kn">import</span> <span class="nn">spock.lang.Stepwise</span>
<span class="kn">import</span> <span class="nn">support.AuthorDialogSpec</span>

<span class="nd">@Stepwise</span>
<span class="kd">class</span> <span class="nc">GenericDetailsAuthorDialogSpec</span> <span class="kd">extends</span> <span class="n">AuthorDialogSpec</span> <span class="o">{</span>

    <span class="n">String</span> <span class="n">pathPage</span> <span class="o">=</span> <span class="s2">"components/details"</span>
    <span class="n">String</span> <span class="n">pathSite</span> <span class="o">=</span> <span class="s2">"mnt/override/apps/aemdesign"</span>
    <span class="n">String</span> <span class="n">language</span> <span class="o">=</span> <span class="s2">""</span>
    <span class="n">String</span> <span class="n">componentPath</span> <span class="o">=</span> <span class="s2">"generic-details/v1/generic-details/_cq_dialog"</span>
    <span class="n">String</span> <span class="n">pageExtensionSuffix</span> <span class="o">=</span> <span class="s2">"/content/aemdesign-showcase/au/en/component/details/generic-details/jcr:content/article/par/contentblock7/par/genericdetails"</span>

    <span class="kt">def</span> <span class="nf">setupSpec</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">loginAsAdmin</span><span class="o">()</span>
    <span class="o">}</span>

    <span class="kt">def</span> <span class="nf">cleanupSpec</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">analyzeLog</span><span class="o">()</span>
    <span class="o">}</span>

    <span class="kt">def</span> <span class="s2">"Dialog of Component with Content"</span><span class="o">()</span> <span class="o">{</span>

        <span class="nl">given:</span> <span class="s2">"Component dialog exist"</span>
        <span class="kt">def</span> <span class="n">selector</span> <span class="o">=</span> <span class="s2">"coral-dialog"</span>

        <span class="nl">when:</span> <span class="s2">"I open dialog with content"</span>
        <span class="n">go</span> <span class="s2">"/${pathSite}/${pathPage}/${componentPath}${pageExtension}${pageExtensionSuffix}"</span>

        <span class="nl">then:</span> <span class="s2">"The component dialog should render"</span>
        <span class="n">waitFor</span> <span class="o">{</span> <span class="n">$</span><span class="o">(</span><span class="n">selector</span><span class="o">)</span> <span class="o">}</span>

        <span class="nl">and:</span> <span class="s2">"Dialog should be able to open"</span>
        <span class="n">showDialogDirect</span><span class="o">()</span>
        <span class="n">report</span><span class="o">(</span><span class="s2">"Dialog should be able to open"</span><span class="o">)</span>

        <span class="nl">when:</span> <span class="s2">"When I select Layout tab"</span>
        <span class="n">selectDialogTab</span><span class="o">(</span><span class="s2">"Layout"</span><span class="o">)</span>
        <span class="n">waitFor</span> <span class="o">{</span> <span class="n">tabSelected</span><span class="o">(</span><span class="s2">"Layout"</span><span class="o">)</span> <span class="o">}</span>
        <span class="n">report</span><span class="o">(</span><span class="s2">"Layout tab selected"</span><span class="o">)</span>

        <span class="nl">then:</span> <span class="s2">"Then it should have the Custom Layout options selected and matching configuration options"</span>
        <span class="n">designRefFull</span><span class="o">(</span><span class="n">selector</span><span class="o">,</span> <span class="s2">"tab-layout"</span><span class="o">)</span>

        <span class="nl">where:</span>
        <span class="n">viewport</span> <span class="o">&lt;&lt;</span> <span class="n">getDialogViewPort</span><span class="o">()</span>

    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Once you run this spec you will get an excellent report that will help you determine if the dialog works as you expected it.</p>

<p><img src="/assets/images/automation-testing/dialog-test/generic-details-author-dialog.png" alt="Automation Testing Report - Generic Details" /></p>

<p>As you can see this pattern will allow you to test AEM Dialogs especially if you are into making customised controls, if you are stuck, look at some examples in <a href="https://github.com/aem-design/aemdesign-aem-support/blob/clean-up-compose-project/aemdesign-testing/src/test/groovy/specs/component/details/genericdetails/GenericDetailsAuthorDialogSpec.groovy">GenericDetailsAuthorDialogSpec.groovy</a>.</p>

<p>Don’t forget to tell your friends.</p>]]></content><author><name>Max Barrass</name><email>max@aem.design</email><uri>http://maxbarrass.com</uri></author><category term="blog" /><category term="devops" /><category term="aem" /><category term="testing" /><category term="automation-testing" /><summary type="html"><![CDATA[Automation testing is an absolute mandatory and covered in Automation Testing and Human Reporting and demonstrates a viable, usable AEM Automated Testing approach and does not make the automated testing suite a development only agenda.]]></summary></entry><entry><title type="html">Creating Custom Workflow Step</title><link href="https://aem.design/blog/2021/01/18/creating-custom-workflow-step" rel="alternate" type="text/html" title="Creating Custom Workflow Step" /><published>2021-01-18T00:37:00+11:00</published><updated>2021-03-14T01:50:42+11:00</updated><id>https://aem.design/blog/2021/01/18/creating-custom-workflow-step</id><content type="html" xml:base="https://aem.design/blog/2021/01/18/creating-custom-workflow-step"><![CDATA[<p>When writing custom workflow services, you may find yourself not seeing your service being recognised by the Process Step.
You will first encounter this when you don’t see your service appear in the process list on the dialog.
And once you verify the data source that feeds that dropdown at <a href="http://localhost:4502/libs/cq/workflow/content/console/process.json">http://localhost:4502/libs/cq/workflow/content/console/process.json</a> you will wonder why.
You may also see errors like this <code class="language-plaintext highlighter-rouge">Could not find service for service reference {YOUR WORKFLOW STEP CLASS PATH} with label {no label}</code> that could just tell you your class is missing property <code class="language-plaintext highlighter-rouge">process.label</code>.</p>

<p>Now that you know, you add this property to your class and your class appear in the list, here is an example of how to add it:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span><span class="o">(</span>
    <span class="n">immediate</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span>
    <span class="n">service</span> <span class="o">=</span> <span class="nc">WorkflowProcess</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
    <span class="n">property</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"process.label=Content Fragment Page Generator"</span> <span class="o">}</span>
    <span class="o">)</span>
</code></pre></div></div>

<p>Also while debugging this, you may find some other errors polluting your docker logs.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The activate method has thrown an exception (java.lang.IllegalStateException: org.apache.sling.api.resource.LoginException: Cannot derive user name for bundle com.adobe.acs.acs-aem-commons-bundle [553] and sub service workflowpackagemanager-service
</code></pre></div></div>

<p>To fix this, all you need to do is add missing service mapping mentioned in the message.
You should be able to replicate this by restarting your missing component at eg <a href="http://localhost:4502/system/console/components/design.aem.workflow.process.ContentFragmentPageGenerator">http://localhost:4502/system/console/components/design.aem.workflow.process.ContentFragmentPageGenerator</a>.
In example above missing use name is <code class="language-plaintext highlighter-rouge">workflowpackagemanager-service</code> and bundle is <code class="language-plaintext highlighter-rouge">com.adobe.acs.acs-aem-commons-bundle</code>.
To add this missing entry do this:</p>

<ul>
  <li>open <a href="http://localhost:4502/system/console/configMgr/">http://localhost:4502/system/console/configMgr/</a></li>
  <li>search for <code class="language-plaintext highlighter-rouge">com.adobe.acs.acs-aem-commons-bundle</code> look for mapping in <code class="language-plaintext highlighter-rouge">Apache Sling Service User Mapper Service Amendment</code></li>
  <li>add or update blank entry with <code class="language-plaintext highlighter-rouge">com.adobe.acs.acs-aem-commons-bundle:workflowpackagemanager-service=workflow-process-service</code></li>
</ul>

<p>Hopefully, after this, your custom workflow step will work, if you are stuck, look at some examples in <a href="https://github.com/aem-design/aemdesign-aem-core/tree/develop/aemdesign-aem-services/src/main/java/design/aem/workflow/process">aemdesign-aem-services/../workflow/process</a>.</p>

<p>Don’t forget to tell your friends.</p>]]></content><author><name>Max Barrass</name><email>max@aem.design</email><uri>http://maxbarrass.com</uri></author><category term="blog" /><category term="devops" /><category term="aem" /><category term="structure" /><category term="bugs-maybe" /><summary type="html"><![CDATA[When writing custom workflow services, you may find yourself not seeing your service being recognised by the Process Step. You will first encounter this when you don’t see your service appear in the process list on the dialog. And once you verify the data source that feeds that dropdown at http://localhost:4502/libs/cq/workflow/content/console/process.json you will wonder why. You may also see errors like this Could not find service for service reference {YOUR WORKFLOW STEP CLASS PATH} with label {no label} that could just tell you your class is missing property process.label.]]></summary></entry><entry><title type="html">Using Docker to Build Code</title><link href="https://aem.design/blog/2020/07/24/using-docker-to-build-code" rel="alternate" type="text/html" title="Using Docker to Build Code" /><published>2020-07-24T23:37:00+10:00</published><updated>2021-03-14T01:50:42+11:00</updated><id>https://aem.design/blog/2020/07/24/using-docker-to-build-code</id><content type="html" xml:base="https://aem.design/blog/2020/07/24/using-docker-to-build-code"><![CDATA[<p>When you have been working for a long time on a codebase, you don’t tend to test if your code can be compiled on other machines. Most of the time, it means that it won’t. But when you have Docker on your side, your dispair would be a one short docker command line deep.</p>

<p>Using Docker to build your code is so easy even your friend will think you are cool when you tell them about it.  The most amazing thing that you don’t even need to write any Docker images, there are so many ready-to-go buildpack containers out there you can easily pick up something that you need.</p>

<p>Here is an example of a container we use to do pipeline build and its very suitable for compiling your project on your local desktop. This container is a Centos 7 Jave Build Pack which means that it comes preconfigured with a majority of tools that are needed to compile our projects.</p>

<p>This container comes with Jave, NPM and RVM, and you can take a look at the contents of the <a href="https://github.com/aem-design/docker-centos-java-buildpack/blob/master/Dockerfile">dockerfile</a>.</p>

<p>In power Shell:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">docker</span><span class="w"> </span><span class="nx">run</span><span class="w"> </span><span class="nt">-it</span><span class="w"> </span><span class="nt">-v</span><span class="w"> </span><span class="nv">${PWD}</span><span class="p">:</span><span class="nx">/build/source</span><span class="w"> </span><span class="nt">-v</span><span class="w"> </span><span class="nv">${HOME}</span><span class="nx">/.m2:/build/.m2</span><span class="w"> </span><span class="nt">--net</span><span class="o">=</span><span class="n">host</span><span class="w"> </span><span class="nx">aemdesign/centos-java-buildpack</span><span class="w"> </span><span class="nx">/bin/bash</span><span class="w"> </span><span class="nt">--login</span><span class="w">
</span></code></pre></div></div>

<p>In Bash:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="nt">-it</span> <span class="nt">-v</span> <span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>:/build/source <span class="nt">-v</span> <span class="k">${</span><span class="nv">HOME</span><span class="k">}</span>/.m2:/build/.m2 <span class="nt">--net</span><span class="o">=</span>host aemdesign/centos-java-buildpack /bin/bash <span class="nt">--login</span>
</code></pre></div></div>

<p>Let’s break this command down.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">-it</code> means run interactive terminal</li>
  <li><code class="language-plaintext highlighter-rouge">-v ${PWD}:/build/source</code> map current path into container at path <code class="language-plaintext highlighter-rouge">/build/source</code>
    <ul>
      <li>in Powershell ${PWD} is same as <code class="language-plaintext highlighter-rouge">pwd</code> in bash</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">-v ${HOME}/.m2:/build/.m2</code> map your Maven cache folder into the container to reuse your already downloaded jars</li>
  <li><code class="language-plaintext highlighter-rouge">--net=host</code> allow container to access your desktop localhost</li>
  <li><code class="language-plaintext highlighter-rouge">amdesign/centos-java-buildpack</code> image to use</li>
  <li><code class="language-plaintext highlighter-rouge">/bin/bash --login</code> run bash and perform login to ensure all of the start-up profile scripts are executed</li>
</ul>

<p>All you need to do now is to run this command in the directory where you have your code and start compiling like a boss.</p>

<p>Don’t forget to tell your friends.</p>]]></content><author><name>Max Barrass</name><email>max@aem.design</email><uri>http://maxbarrass.com</uri></author><category term="blog" /><category term="devops" /><category term="aem" /><category term="docker" /><summary type="html"><![CDATA[When you have been working for a long time on a codebase, you don’t tend to test if your code can be compiled on other machines. Most of the time, it means that it won’t. But when you have Docker on your side, your dispair would be a one short docker command line deep.]]></summary></entry><entry><title type="html">AEM SaaS Hands On 😍🚀🔭</title><link href="https://aem.design/blog/2020/02/01/aem-saas-hands-on%F0%9F%98%8D%F0%9F%9A%80%F0%9F%94%AD" rel="alternate" type="text/html" title="AEM SaaS Hands On 😍🚀🔭" /><published>2020-02-01T00:37:00+11:00</published><updated>2021-03-14T01:50:42+11:00</updated><id>https://aem.design/blog/2020/02/01/aem-saas-hands-on</id><content type="html" xml:base="https://aem.design/blog/2020/02/01/aem-saas-hands-on%F0%9F%98%8D%F0%9F%9A%80%F0%9F%94%AD"><![CDATA[<div class="sticky">
    <aside class="sidebar__right">
<nav class="toc">
      <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On This Page</h4></header>
<ul class="toc__menu" id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#aem-saas-author-hand-on" id="markdown-toc-aem-saas-author-hand-on">AEM SaaS Author Hand On</a>    <ul>
      <li><a href="#environments" id="markdown-toc-environments">Environments</a></li>
      <li><a href="#pipeline" id="markdown-toc-pipeline">Pipeline</a></li>
    </ul>
  </li>
  <li><a href="#aem-saas-pipelines-breakdown" id="markdown-toc-aem-saas-pipelines-breakdown">AEM SaaS Pipelines Breakdown</a>    <ul>
      <li><a href="#validation" id="markdown-toc-validation">Validation</a></li>
      <li><a href="#build--unit-testing" id="markdown-toc-build--unit-testing">Build &amp; Unit Testing</a></li>
      <li><a href="#code-scanning" id="markdown-toc-code-scanning">Code Scanning</a></li>
      <li><a href="#build-images" id="markdown-toc-build-images">Build Images</a></li>
      <li><a href="#deploy-to-dev" id="markdown-toc-deploy-to-dev">Deploy to Dev</a></li>
    </ul>
  </li>
  <li><a href="#aem-saas-pipelines-whats-missing" id="markdown-toc-aem-saas-pipelines-whats-missing">AEM SaaS Pipelines What’s missing</a>    <ul>
      <li><a href="#git-peer-review-workflow" id="markdown-toc-git-peer-review-workflow">Git Peer Review Workflow</a></li>
      <li><a href="#automated-functional-testing" id="markdown-toc-automated-functional-testing">Automated Functional testing</a></li>
      <li><a href="#no-git-lfs" id="markdown-toc-no-git-lfs">No Git LFS</a></li>
      <li><a href="#no-felix-console" id="markdown-toc-no-felix-console">No Felix Console</a></li>
    </ul>
  </li>
  <li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></li>
</ul>

    </nav>
</aside>
</div>

<h1 id="introduction">Introduction</h1>

<p>If <a href="/blog/2019/10/20/enter-the-github-actions">Github Actions</a> was entry into End Game, latest Adobe AEM SaaS offering is the outcome of an End Game in another dimension, where Adobe is the clear victor! This stealthy engineering masterpiece is a true example of how great experience can provide so much, that words can’t describe the feeling.</p>

<p>Adobes new offering it’s a true testament to engineering and a huge demonstration to all vendors in this space, on how to do things that make a difference. Not often you get your hands on a piece of SaaS software where you open the console and see something that takes your breath away. Your world is turned, and you whisper to yourself this can’t be true, it can’t be that easy.</p>

<p><strong><em>Well folk, it is!</em></strong></p>

<p>Latest offering from Adobe demonstrates their commitment on Experiences and not only for End Users but also for Developers.</p>

<p>This new offering is the Kubernetes powered, container infused, sling application building behemoth, breathing CI/CD life into your projects with ease!</p>

<p>You can find plenty post and materials about tech behind the platform, but this post is about the Experience! We want to see show off the new Cloud Manager experience. This post should provide you with inspiration to jump onto the CI/CD experience that Adobe have gifted upon us!</p>

<p>So, without any further ado let’s jump straight to it.</p>

<h1 id="aem-saas-author-hand-on">AEM SaaS Author Hand On</h1>

<p>To start playing with your Cloud Manager experience you will need to access it thought your Adobe Experience portal, this will be provided for you by Adobe but for now you can follow our blog to get the insight and prepare you to roll-out your first project.</p>

<p>First off you need to login to Adobe Experience Platform, this will allow you not only to login into AEC using your Adobe account but also provides same access to all AEM instances in the Cloud Manager! Which is amazing and so on SSO trend of 2020! Login screen is similar to the all of the login screens Adobe has been slowly introducing in last few years.</p>

<p><img src="/assets/images/adobe-aec/1-login.png" alt="Adobe SSO Login Page" /></p>

<p>You can still use shared local admin accounts (you get one you share with Adobe) but it’s not something you should do in AEC and at all, for many painful reasons.</p>

<p>Once you have logged in you will be redirected to the AEC dashboard.</p>

<p><img src="/assets/images/adobe-aec/2-adobe-experience-cloud-overview.png" alt="AEM Adobe Experience Cloud Dashboard" /></p>

<p>When you click the Experience Manager icon you should see Cloud Manager card with Launch link.</p>

<p><img src="/assets/images/adobe-aec/2-adobe-experience-cloud-ams-cloudmanager.png" alt="AEM Adobe Experience Cloud Manager Launch" /></p>

<p>Clicking Launch on Cloud Manager card will lead you at AEC Program Overview page.</p>

<p><img src="/assets/images/adobe-aec/4-aec-program-console.png" alt="AEC - Cloud Manager - Program Overview " /></p>

<p>This console is your command centre for your environments and associated pipelines. From here you can control your environments, download logs, create and action pipelines. From now on this is the engine of your project!</p>

<p><img src="/assets/images/adobe-aec/5-aec-program-console-manage.png" alt="AEC - Cloud Manager - Environments" /></p>

<p>First thing you will notice is the large banner across the top, this is your production status panel, it will report to you how your Production pipeline is going.</p>

<p>Just under that you will see two sections Environments and Pipelines.</p>

<h2 id="environments">Environments</h2>

<p>Environments section allow you to check status of your environments, update and create new environments, download environment logs, access new environments, all of the features readily available and tucked away in the ellipsis (<code class="language-plaintext highlighter-rouge">...</code>) revealing a simple menu with only but primary experiences you are looking for. Additionally, when you click the Details button in this section you will be taken to a details screen that will show you</p>

<p><img src="/assets/images/adobe-aec/4-aec-program-console-environments-details.png" alt="AEC - Cloud Manager - Environments Details" /></p>

<p>Available Configuration is tied to your account and point allocated for environments. You will only be able to have environments that have been assigned to you by Adobe. Spinning up and tearing down of the environments is as simple as clicking a submenu item on the environment.</p>

<h2 id="pipeline">Pipeline</h2>

<p>Pipeline section allow you to create, update and run pipelines and this is broken down into Production and Non-Production. Manage Git button shows you a dialog that points you to the Adobe Git repo you will need to use when committing code.</p>

<p>Although environments will be your initial focus it will very quickly switch to the Pipelines which you will spend most of your time watching. 😍</p>

<p>So, let’s deep dive on the pipeline and what we can decipher from it’s logs.</p>

<h1 id="aem-saas-pipelines-breakdown">AEM SaaS Pipelines Breakdown</h1>

<p>Adobe pipeline offer is simple, it provides a dream pipeline process where you start with Adobe hosted Git Repo and fork into Quality or Deploy pipeline process.</p>

<p>This is a simple methodology and it seem to work as it saves a bunch of time on a project. All the team need to do is just get their code into the repo and everything is done for them, that has not existed with this ease until now.</p>

<p><img src="/assets/images/adobe-aec/7-aec-program-non-prod-pipeline-execution-complete.png" alt="AEM Saas Program Console" /></p>

<p>As you can tell from the image the pipeline is divided into following stages</p>

<ul>
  <li>Validation - initial verify of your repo?</li>
  <li>Build &amp; Unit Testing - maven build and test</li>
  <li>Code Scanning - SonarQube evaluation</li>
  <li>Build Images - Docker and Sling app build process</li>
  <li>Deploy to Dev - Docker release and package install</li>
</ul>

<p>This is similar process for PROD but with extra testing and approval steps.</p>

<p>As you can see the Non-Prod Deploy pipeline breakdown is simple so now let’s look what is happening under covers, let’s talk about notable things that can be observed from the logs.</p>

<h2 id="validation">Validation</h2>
<p>No logs available for this but “Your Pipeline has been verified against a set of sanity checks.” could mean a lot of things, but it runs very fast so guessing it’s aim is just to check you have a Git repo with valid pom.xml that could be compiled, that could be a good start.</p>

<p>This step takes about 5min to run from our tests.</p>

<h2 id="build--unit-testing">Build &amp; Unit Testing</h2>

<p>In “build_maven_build.log” you can see <code class="language-plaintext highlighter-rouge">[BUILD] Running maven build command(s)</code> line and judging by what happens after that simple <code class="language-plaintext highlighter-rouge">mvn package</code> command is used as it compiles, tests and packages all modules in you project.</p>

<p>This step runs for about 5min and it would depend on your package and test content. It’s not clear from the logs if the artifacts are cached at this step or after code scan.</p>

<h2 id="code-scanning">Code Scanning</h2>

<p>This is where magic is starting to come into play. First of you get a nice review summary screen that shows you what the damage of your latest code cram, and it’s cool way of summarising underlying tools!</p>

<p><img src="/assets/images/adobe-aec/7-aec-program-non-prod-pipeline-execution-complete-codescan.png" alt="AEM Saas Pipleine CodeScan Result" /></p>

<p>In addition to this you get to see a CSV that shows you things that you need to fix.</p>

<table>
  <thead>
    <tr>
      <th>File Location</th>
      <th>Line Number</th>
      <th>Issue</th>
      <th>Type</th>
      <th>Severity</th>
      <th>Effort</th>
      <th>Rule</th>
      <th>Tags</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>design.aem:aemdesign-aem-common:2.0.618</td>
      <td>0</td>
      <td>Node /apps/aemdesign/install is an OSGi config or install path which contains non-OSGi-related children that will not be visible to non-administrative users.</td>
      <td>Bug</td>
      <td>Major</td>
      <td> </td>
      <td>ConfigAndInstallShouldOnlyContainOsgiNodes</td>
      <td>aem</td>
    </tr>
    <tr>
      <td>design.aem:aemdesign-aem-common:2.0.618</td>
      <td>0</td>
      <td>Node /apps/aemdesign/components/template/cloudconfig/addthisconnect/config is an OSGi config or install path which contains non-OSGi-related children that will not be visible to non-administrative users.</td>
      <td>Bug</td>
      <td>Major</td>
      <td> </td>
      <td>ConfigAndInstallShouldOnlyContainOsgiNodes</td>
      <td>aem</td>
    </tr>
    <tr>
      <td>design.aem:aemdesign-aem-common:2.0.618</td>
      <td>0</td>
      <td>Node /apps/aemdesign/components/lists/searchlist/v2/searchlist/cq:dialog/content/items/layoutTab/items/column/items/config is an OSGi config or install path which contains non-OSGi-related children that will not be visible to non-administrative users.</td>
      <td>Bug</td>
      <td>Major</td>
      <td> </td>
      <td>ConfigAndInstallShouldOnlyContainOsgiNodes</td>
      <td>aem</td>
    </tr>
    <tr>
      <td>design.aem:aemdesign-aem-common:2.0.618</td>
      <td>0</td>
      <td>Node /apps/aemdesign/global/dialog/touch/badge/content/items/badgeConfigTab/items/column/items/config is an OSGi config or install path which contains non-OSGi-related children that will not be visible to non-administrative users.</td>
      <td>Bug</td>
      <td>Major</td>
      <td> </td>
      <td>ConfigAndInstallShouldOnlyContainOsgiNodes</td>
      <td>aem</td>
    </tr>
    <tr>
      <td>design.aem:aemdesign-aem-common:2.0.618</td>
      <td>0</td>
      <td>Node /apps/aemdesign/components/template/cloudconfig/googleanalytics/config is an OSGi config or install path which contains non-OSGi-related children that will not be visible to non-administrative users.</td>
      <td>Bug</td>
      <td>Major</td>
      <td> </td>
      <td>ConfigAndInstallShouldOnlyContainOsgiNodes</td>
      <td>aem</td>
    </tr>
    <tr>
      <td>design.aem:aemdesign-aem-common:2.0.618</td>
      <td>0</td>
      <td>Node /apps/aemdesign/components/media/image/v2/image/cq:editConfig/cq:inplaceEditing/config is an OSGi config or install path which contains non-OSGi-related children that will not be visible to non-administrative users.</td>
      <td>Bug</td>
      <td>Major</td>
      <td> </td>
      <td>ConfigAndInstallShouldOnlyContainOsgiNodes</td>
      <td>aem</td>
    </tr>
    <tr>
      <td>design.aem:aemdesign-aem-common:2.0.618</td>
      <td>0</td>
      <td>Node /apps/aemdesign/components/template/cloudconfig/googlemap/config is an OSGi config or install path which contains non-OSGi-related children that will not be visible to non-administrative users.</td>
      <td>Bug</td>
      <td>Major</td>
      <td> </td>
      <td>ConfigAndInstallShouldOnlyContainOsgiNodes</td>
      <td>aem</td>
    </tr>
  </tbody>
</table>

<p><em>PS. this is the complete list of issues that we got for first deploy of AEM.Design to Adobe SaaS offering.</em></p>

<p>Just looking at this the reported Severity seems to be very opinionated and super conservative. Having a readme file in your <code class="language-plaintext highlighter-rouge">/apps/aemdesign/install</code> folder does not make it a Major defect, but this it probably just splitting hairs at this point and removing that file is trivial.</p>

<p>Errors such as <code class="language-plaintext highlighter-rouge">/apps/aemdesign/components/template/cloudconfig/addthisconnect/config is an OSGi config or install path which contains non-OSGi-related children that will not be visible to non-administrative users.</code> seem to fail the blank <code class="language-plaintext highlighter-rouge">config</code> node name rule and yes this is Major once again.</p>

<p>These trivial issues will get some great solution in time as this is a great process to put in place for all AEM project from the start. Many AEM project will benefit from establishing initial baseline and would provide a clear for quality path.</p>

<p>This step takes about 5min to run, this would depend on amount of code you throw at it.</p>

<h2 id="build-images">Build Images</h2>

<p>This phase is responsible for generating two brand new Docker images that has all of your new code embedded into it. First image will contain all of your project contents and second image will be a final merged version of your project with latest AEM base image.</p>

<p>Essentially process builds a custom CRX-Quickstart with your features(converted packages) embedded into it from the start, this does mean that you will not be able to download or delete the packages using CRX/DE and with added benefit of separating these code package from actual content in your repository.</p>

<p><img src="/assets/images/adobe-aec/11-aem-saas-crxde-packages.png" alt="AEM Saas CRX/DE Packages" /></p>

<p>The logs show standard Docker build process with bunch of parameters being passed to the Docker build process. Namely the build process relies on Packages that were built in previous steps these are passed as a URL list which are downloaded and converted to <a href="https://github.com/apache/sling-org-apache-sling-feature">Sling Features</a> using tool similar to <a href="https://github.com/apache/sling-org-apache-sling-feature-cpconverter">sling-org-apache-sling-feature-cpconverter</a>.</p>

<p>The process also creates a list of packages that are have content to be installed into repository, this list is used in deploy step.</p>

<p>All the packages once converted get store into <code class="language-plaintext highlighter-rouge">src/main/features/generated-author</code> with relevant JSON files describing features in <code class="language-plaintext highlighter-rouge">src/main/features/generated/001_sew-aem-common.json</code>. After this a maven build process is executed to compile your features into latest version (at the time of writing 6.6.0-V17414) of AEM Quickstart. Adobe has indicated that they are moving towards daily releases so this means that this process will pick up latest version of AEM when it’s available.</p>

<p>After this conversion and merger of AEM sling features, AEM image is started as container to initialise it’s segment store. Once the instance is initialising it’s stopped and Apache Jackrabbit Oak maintenance is executed, first checkpoint then compact. Once this is done both docker images are uploaded to Adobes Docker Image Repository. And this same process repeats for Publish images changing runmode=publish in the process.  At the end of this process which takes around 10-15 min to run you end up with Author and Publish images sizing at 4GB each.</p>

<h2 id="deploy-to-dev">Deploy to Dev</h2>

<p>Deploy phase starts with downloading content packages that were isolated in previous phase. Followed by starting and waiting for Author instance, at which is tries to install downloaded packages into the instance and stop the instance on completion.</p>

<p>After this next process start the author and runs a bunch of bash scripts, that enable features, nodestore, blobstore, logging, set admin password validate and link license key. After this AEM is started once again and once ready is stopped and Oak Indexes are regenerated.</p>

<p>After this 10+ min step that instance is started again and marked as available for use, which is not recoded in logs and must be an extra step outside of the pipeline.</p>

<p>As you can see this is straight forward pipeline that just works. Lets discuss the obvious question that is at the top our mind right about now. What’s missing?</p>

<h1 id="aem-saas-pipelines-whats-missing">AEM SaaS Pipelines What’s missing</h1>

<p>Well as this is hosted on AEM there will be a few CI/CD limitations. Limitations are good as they provide less distraction and an opportunity to improve. Here are the things that we find missing so far, they are not deal breakers but good to keep on the back of your mind.</p>

<h2 id="git-peer-review-workflow">Git Peer Review Workflow</h2>

<p>Adobe Git is only a URL to which you push your code, these days all development should revolve around Pull Request Approval process. Covering benefits of this is not required as they are covered in great depth in many articles.</p>

<p>To enable this process to happen on your projects you will need to use external Git repo and manage code reviews there before you publish this final code into Adobe Git.</p>

<p>This is a small inconvenience and it’s readily fixed seeing as all companies these days have a form of Git and in cases where that’s not the case, GitHub, Bitbucket and Gitlab all support this process for free. Additionally, these tools have built in pipeline tools that will help you to push code to Adobe Git.</p>

<h2 id="automated-functional-testing">Automated Functional testing</h2>

<p>Screenshot testing using Selenium or other testing tools is not in and you would need to cater for that yourselves. Most obvious reason for this as there is no one way of doing this and everyone does what they need for their situation.</p>

<p>Additionally, current Deploy pipelines are fixed to a specific flow which you cannot change. This means that in cases where you need to do automated functional testing you would need to do this using external pipeline.</p>

<p>Potentially you could just run your automation test tool of choice manually against a Dev instance in the Adobe environment. But in cases where you would like this to be automated you would have followed another approach.</p>

<p>One approach could be is to still have external Git repo and a pipeline that could build and test code and on success push it to Adobe Git for release to Dev cycle. This would be an ok mechanism as you could do this free on GitHub using containers see <a href="https://aem-design.github.io/aemdesign-aem-support-output/">Exhibit 1</a> that runs in GitHub Actions pipeline. Plus, you would get PR ability.</p>

<h2 id="no-git-lfs">No Git LFS</h2>

<p>If you are using Git Lfs you going to need to revert to plain git as there is not Git Lfs in Adobe’s Git and you will end up publishing pointers to your images into AEM.</p>

<h2 id="no-felix-console">No Felix Console</h2>

<p>There is no Felix Console, but there is a brand-new custom Developers Console that provides very limited tools that you might use.</p>

<p><img src="/assets/images/adobe-aec/12-developer-console-status.png" alt="AEM New Developer Console" /></p>

<p>Standard Felix console does have a lot of features and some can cause a few issues so it’s no surprise it’s not available and have been replaced with a tool that allows you download that for review.</p>

<p>Here are some of the available screens, Status screen will be your main go-to console to download content of some frequently used Felix console.</p>

<style>
    .image-gallery {overflow: auto; margin-left: -1%!important;}
    .image-gallery li {float: left; display: block; margin: 0 0 1% 1%; width: 19%;}
    .image-gallery li a {text-align: center; text-decoration: none!important; color: #777;}
    .image-gallery li a span {display: block; text-overflow: ellipsis; overflow: hidden; white-space: nowrap; padding: 3px 0;}
    .image-gallery li a img {width: 100%; display: block;}
</style>

<ul class="image-gallery">
    <li>
        <a href="/assets/images/adobe-aec/developerconsole/12-developer-console-java-packages.png" title="12-developer-console-java-packages"><img src="https://images.weserv.nl/?url=aem.design/assets/images/adobe-aec/developerconsole/12-developer-console-java-packages.png&amp;w=300&amp;h=300&amp;output=png&amp;q=50&amp;t=square" alt="12-developer-console-java-packages" title="12-developer-console-java-packages" /><span>12-developer-console-java-packages</span></a>
    </li>

    <li>
        <a href="/assets/images/adobe-aec/developerconsole/12-developer-console-queries.png" title="12-developer-console-queries"><img src="https://images.weserv.nl/?url=aem.design/assets/images/adobe-aec/developerconsole/12-developer-console-queries.png&amp;w=300&amp;h=300&amp;output=png&amp;q=50&amp;t=square" alt="12-developer-console-queries" title="12-developer-console-queries" /><span>12-developer-console-queries</span></a>
    </li>

    <li>
        <a href="/assets/images/adobe-aec/developerconsole/12-developer-console-servlets.png" title="12-developer-console-servlets"><img src="https://images.weserv.nl/?url=aem.design/assets/images/adobe-aec/developerconsole/12-developer-console-servlets.png&amp;w=300&amp;h=300&amp;output=png&amp;q=50&amp;t=square" alt="12-developer-console-servlets" title="12-developer-console-servlets" /><span>12-developer-console-servlets</span></a>
    </li>

    <li>
        <a href="/assets/images/adobe-aec/developerconsole/12-developer-console-status-download-logs.png" title="12-developer-console-status-download-logs"><img src="https://images.weserv.nl/?url=aem.design/assets/images/adobe-aec/developerconsole/12-developer-console-status-download-logs.png&amp;w=300&amp;h=300&amp;output=png&amp;q=50&amp;t=square" alt="12-developer-console-status-download-logs" title="12-developer-console-status-download-logs" /><span>12-developer-console-status-download-logs</span></a>
    </li>

</ul>

<h1 id="conclusion">Conclusion</h1>

<p>As this is an Adobe’s work in progress and the masterpiece is not finished yet, it’s expected that new features will be added as adoption grows.</p>

<p>It will not take you long to get used to all the options and you will soon be longing for this simplicity in everything. Alternatives experiences to this are far more complicated and although they are fun to create, they can divert your attention and that you need not to do anymore!</p>

<p>From development perspective there are a lot of features that you will not see migrated which is a good thing, as Adobe’s engineers have a good handle on what is used and it’s usefulness beyond just being there part of a legacy.</p>

<p>So, we hope you have had just enough content to give you a quick overview and excite you to jump on board.</p>

<p>There is a whole array of documentation available at your favourite site in the <a href="https://docs.adobe.com/content/help/en/experience-manager-cloud-manager/using/introduction-to-cloud-manager.html">Experience Manager Cloud Manager Help</a> section, explore the new capability that is at your disposal and review official docs if you get stuck.</p>

<p>As always if you want more drop us a line, checkout the code and submit some issues if you find any.</p>]]></content><author><name>Max Barrass</name><email>max@aem.design</email><uri>http://maxbarrass.com</uri></author><category term="blog" /><category term="devops" /><category term="aem" /><category term="saas" /><category term="knowledge" /><category term="sharing" /><category term="handson" /><summary type="html"><![CDATA[This is the End Game and Adobe has it, a non-definitive perspective!]]></summary></entry><entry><title type="html">AEM Magento Integration 😍🚀🔭</title><link href="https://aem.design/blog/2020/03/06/aem-magento-integration%F0%9F%98%8D%F0%9F%9A%80%F0%9F%94%AD" rel="alternate" type="text/html" title="AEM Magento Integration 😍🚀🔭" /><published>2020-02-01T00:37:00+11:00</published><updated>2021-04-26T11:04:40+10:00</updated><id>https://aem.design/blog/2020/03/06/aem-magento-integration</id><content type="html" xml:base="https://aem.design/blog/2020/03/06/aem-magento-integration%F0%9F%98%8D%F0%9F%9A%80%F0%9F%94%AD"><![CDATA[<h2 id="introduction">Introduction</h2>

<p>AEM when integrated with an eCommerce provider provides a great experience for online shopping functionalities.</p>

<p>eCommerce functionality is inherent in AEM which shows from demo sites like we retail.
As AEM provides very perfect handling of content like authoring and publishing and managing assets, integrating it with eCommerce system provides a perfect way to build a robust eCommerce site.</p>

<p>AEM connects with eCommerce providers, Like SAP Commerce, Salesforce, Magento and more. AEM provides specific eCommerce frameworks to connect to eCommerce providers.
In this blog we are going to see how AEM connects to Magento eCommerce. There are two ways to connect to an eCommerce provider Adobe IO or Commerce Integration Framework for a provider.
Because AEM provides a Commerce Integration Framework connector to connect to Magento, we will be using that. CIF uses GraphQL queries to talk to Magento and bring data.</p>

<p>Note: To connect to eCommerce providers other than Magento we need to go through Adobe IO. For more info visit. : https://www.adobe.io/apis/experiencecloud/commerce-integration-framework/faq.html</p>

<p>Let’s jump into the steps to implement CIF now.</p>

<p>The commerce integration framework can be found at below locations. Adobe provides production ready components also which can be used.</p>

<ul>
  <li><a href="https://github.com/adobe/aem-core-cif-components">AEM CIF components</a></li>
  <li><a href="https://github.com/adobe/commerce-cif-connector">AEM- CIF connector and authoring tools</a></li>
</ul>

<p>Build the CIF connector framework or add in your dependencies. Once installed in AEM we can get option to configure the integration properties.
Two configurations have to be done. GraphQL client configuration and CIF catalog Magento configuration.</p>

<p>Below are the steps where we have configured these.</p>

<h3 id="cif-graphql-client-configuration-factory">CIF GraphQL Client Configuration Factory</h3>

<p>Add GraphQL service – https://magento-hostname/graphql</p>

<p><img src="/assets/images/aem-magento-integration/graphql-client-configuration.png" alt="GraphQL client configuration" /></p>

<h3 id="cif-catalog-magento-graphql-configuration-factory">CIF Catalog Magento GraphQL Configuration Factory</h3>
<p><img src="/assets/images/aem-magento-integration/cif-magento-graphql-configuration.png" alt="CIF magento graphql configuration" /></p>

<p>Once configured Test the connection in postman, using below query. Results depend on correct products configuration in Magento also.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
	category(id: 2) {
		id, name, url_path, product_count, children_count, children {
			id, name, url_path, product_count, children_count, children {
				id, name, url_path, product_count, children_count, children {
					id, name, url_path, product_count, children_count, children {
						id, name, url_path, product_count, children_count
					}
				}
			}
		}
	}
}
</code></pre></div></div>

<p>The response must return results with exact numbers. A sample result is below</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
	"data": {
		"category": {
			"id": 2,
			"name": "Default Category",
			"url_path": null,
			"product_count": 7,
			"children_count": "3",
			"children": [{
				"id": 5,
				"name": "Mens",
				"url_path": "mens-shirts",
				"product_count": 2,
				"children_count": "1",
				"children": [{
					"id": 6,
					"name": "Footwear",
					"url_path": "mens-shirts\/footwear",
					"product_count": 1,
					"children_count": "0",
					"children": []
				}]
			}, {
				"id": 4,
				"name": "SubCategory01",
				"url_path": "subcategory01",
				"product_count": 2,
				"children_count": "0",
				"children": []
			}]
		}
	}
}
</code></pre></div></div>

<p>Now it’s time to create binding in AEM Commerce. This will fetch us the products from Magento to use anywhere or in commerce components.</p>

<p>Below image describes the binding configuration.
<img src="/assets/images/aem-magento-integration/magento-binding.png" alt="Binding" /></p>

<p>Once binding is successfully done, results can be seen in AEM ecommerce. The below image shows results in AEM ecommerce after successful binding with Magento.
<img src="/assets/images/aem-magento-integration/Product-Shoe.png" alt="Binding" /></p>

<p>Thank you.</p>]]></content><author><name>Saket Mishra</name><email>saket.mishra.kr@gmail.com</email></author><category term="blog" /><summary type="html"><![CDATA[Integrate AEM with Magento to us eCommerce functionality!]]></summary></entry><entry><title type="html">AEM Framework for Multi-Tenant Environments.</title><link href="https://aem.design/blog/2020/01/12/aem-framework-for-multi-tenant-environments" rel="alternate" type="text/html" title="AEM Framework for Multi-Tenant Environments." /><published>2020-01-12T00:37:00+11:00</published><updated>2021-03-14T01:50:42+11:00</updated><id>https://aem.design/blog/2020/01/12/aem-framework-for-multi-tenant-environments</id><content type="html" xml:base="https://aem.design/blog/2020/01/12/aem-framework-for-multi-tenant-environments"><![CDATA[<h1 id="introduction">Introduction</h1>

<p>AEM.Design is about identifying best practices and patterns that should be embedded and used a starting point for creating solutions for AEM. Our approach is to combine these best practices and patterns into the open-source framework that can accelerate projects and provide a pathway for sharing knowledge with the community in a consumable production-ready framework. A lot of articles detail individual knowledge fragments that at times useful on their own but do not provide a clear direction for end-use. We have tried to create a consolidated reference end-to-end approach with AEM.design framework and tools.</p>

<p>This initiative aims at collating best practices and patterns that are proven to be useful on projects. It aims to leverage best practices not only from AEM knowledge base but also leverage best of the best from Front End, Automation Testing, DevOps and another related enablement tech. The aim of this initiative to provide a framework that can fit into existing solution practices without mandating a particular process.</p>

<p>All of the code is located in GitHub, Docker Hub, SonarCloud and published to Maven central.</p>

<p>Best place to start with this framework is to try out the Docker Bundle that has the framework and demo of all of the components. You can find how to get started here: https://aem.design/blog/2019/08/30/docker-aem-bundle</p>

<p>Our archetype project is aimed to generate a new tenant project that has all of the components required to run the AEM implementation project. It including automation tests, site showcase, frontend code implementation and component overrides tailored to you tenant name and project.</p>

<p>If you have any questions on particular issues you can raise issues in GitHub for repos there are a few of them.</p>

<p>Creating and managing an environment for Multi-Tenants requires considerable upfront planning. Starting AEM project is easy, and you can feel a great sense of velocity early on. Although your initial velocity will make you feel comfortable, this might not last and avoid future pitfalls is hard once you have released to production. To avoid pitfalls of the future means that you will need to be aware of some of the pitfalls you might encounter upfront, and this is very hard to convey and predict.</p>

<p>To protect projects from encountering technical pitfalls in the future, it’s recommended to follow several product best practices. A sheer number of best practices and patterns is overwhelming, and it’s tough for new entrants to appreciate all of the suggested practices. We found that establishing a set of goals and principles early on helps to provide a project with a pathway to success.</p>

<p>Technical patterns are easily avoided by leveraging frameworks that seek to embed knowledge into a useful framework. Providing input into business processes is a more complicated endeavour due to the way the project can be executed. From our experience, teams need to aim to establish a common design language which is used to communicate requirements and create an efficient delivery process that builds trust in the tools being used. This requires having open dialogue at the start of the project to ensure everyone is on the same page and are willing to commit to trusting automation process.</p>

<p>Following sections outline some of the elements of knowledge that should be kept in mind when establishing a project for a single site or multi-tenant sites.</p>

<h1 id="business-approach">Business approach</h1>

<p>Be very transparent with the whole team, and every person needs to understand that they will all be required to login into AEM and use it, PMs and steak holders included, after all, it’s their future digital platform. Everyone must learn the basic terminology of AEM and Design Language that will be used to describe requirements, this avoids confusion for everyone, and everyone should be encouraging peers to use correct language.</p>

<ol>
  <li>Select primary Business Analyst to run project knowledge transfer, this will be your primary conduit</li>
  <li>The project team focus is primarily on Authoring Experience, as this what will enable authors to create the visual experiences they want</li>
  <li>Create a common Design Language to ensure designers and BA’s lead the conversation of explaining how designs are authored in AEM, not in some other external concepts</li>
  <li>Establish a religious training for all end-users of AEM</li>
  <li>Create a showcase of you chosen components and walk everyone (including stakeholders) thought it, showcase must be used for functional tests, so it’s not a throwaway</li>
  <li>Establish a common knowledge repository for sharing knowledge while AEM project is running, use Confluence as it’s most accessible, do not treat this knowledge base as a dumping ground of notes, treat it like a knowledge book for the future. This space is for people to see what you have built not read endless meeting notes, all admin related content should not be primary focus for the space</li>
  <li>Establish a author training site that will be updated by Authors and BAs, this should be like any other tenant</li>
  <li>Delay all modification to core Authoring Experience, use YAGNI banner especially if everyone is new to AEM</li>
  <li>Component that appears in multiples experiences(pages) and show same data structure but different visual presentation are variant of same component.</li>
  <li>Focus on identifying Unique Experiences and Unique components Variants that make up those Unique Experiences.</li>
  <li>Ensure analytics is discussed as Definition of Ready for each component.</li>
  <li>Focus on content taxonomies to ensure content structure can scale from the start in DAM, Content Fragments, Experience Fragments, Tags, Forms and Site Pages. Each site should be in its own tenant folder with additional contextual segmentation that   should apply for each type of content.</li>
  <li>Site Content must always be in Region/Language structure with primary Country and Language as default, essentially your site must be multi languish compatible from the start.</li>
  <li>Do not let Information Architecture dictate site Content Architecture</li>
  <li>All legacy SEO ideas and practices (anything that does not talk about microdata in page and components) could be tested using Functional Automation Tests using the Build in AEM Hobes framework. Doing this will allows authors to test their content when they create it. If it can’t be automatically tested, it’s not a requirement; it’s 2020 excuses don’t apply so to drop that requirement if it can’t be tested.</li>
  <li>Acceptance Criteria and Acceptance tests must be part of Definition of Ready for DEV</li>
  <li>Automation testing is not optional, and it’s the only way to verify Definition of Ready.</li>
</ol>

<h1 id="technology-approach">Technology Approach</h1>

<p>For single and Multi-Tenant Projects consider that each site is a “tenant” not a sling workspace tenant but more of a virtual tenant used to segregate content from each site. This addition provides a method for security policies to be applied as users create content, as well as provide a clean separation of content and application code is required, especially as you are working of a single component codebase.</p>

<ol>
  <li>Create a showcase with your chosen components which are maintained Developers throughout development and Testers when helping to test</li>
  <li>Focus on Functional Automation Testing for all components with Authoring (does dialog work), Publishing (does it interact in publish) and Screenshot (does it look right) perspectives. Automation test suit is for the team not for selected few it does not have to be pretty is need to be quick to adopt and allow testing other web services, Selenium still works.</li>
  <li>Leverage Docker containers to ensure you are running consistent versions of services across all environments and especially Developers desktops, see Operations/Docker project</li>
  <li>Run AEM with Segment and Datastore separates from the start</li>
  <li>Leverage external ESB tool for API dev, eg ApacheNifi, try not to write API’s in AEM, external API tools can template/translate requests into direct Sling API request.</li>
  <li>Offload processing to Kubernetes container farm to leverage containers.</li>
  <li>Use overlays for each component per each site, as you will be using multiple framework eventually, this will allow you so substitute/update components in the future.</li>
  <li>Segregate content of each “tenant” into individual sites; this pattern also applies to a number of locations where content is created by authors</li>
  <li>Ensure Pipelines for build and deploy are established as soon as git and repos are created.</li>
  <li>Ensure dispatchers and present for Author and Publish instances</li>
  <li>Ensure that Frontend code is package as a stand-alone package and Page Client Libs are used to include in Templates, see Support/Compose module.</li>
  <li>Leverage VLT tool to export and backup content from prod and import into Development environments as required, packages don’t work for large content farms</li>
  <li>Leverage Ansible to persists logic for environment configuration, see Operations/Deploy and Operations/Ansible-Roles project.</li>
  <li>Ensure dispatcher config is in code and in a Docker container, see Docker-Dispatcher repo</li>
  <li>Do not allow manual modification of services/servers via console etc follow Configuration as Code for all infrastructure and services, especially servers, preferably run Centos Atomic edition which will force Docker usage, see Operations/VM project for how to generate Centos Atomic VMs appliances.</li>
  <li>Leverage Content Fragments for structured content, use templated component to present that content.</li>
  <li>Leverage Experience Fragments for building reusable Page Sections.</li>
  <li>Do not build footer and header as massive components, instead create experience fragments and add them to Site Root page and inherit it thought the tree.</li>
  <li>Ensure Analytics content can be updated by authors</li>
  <li>Use Data Layer spec to output analytics content in page header</li>
  <li>Use Data Layer spec to manage all fields that will be output by components and use for analytics</li>
  <li>Do not implement any components that use any inline javascript for Analytics, no matter what.</li>
  <li>Ensure each component has a unique ID attribute</li>
  <li>Ensure each component you output is easily distinguishable from other stuff AEM adds, AEM.Design uses Boolean attribute “component”</li>
  <li>Use lists for re-using content for presentation, look at Generic Details and List components for reference, they provide dynamic field specific templating and expose of component content without dumping all of the content on the page. Hiding 48 out of 50 fields of a component content is poor design, output only content you need, see Component Variant and List Badge patterns.</li>
  <li>Separate config into a separate package and use run-modes</li>
  <li>Separate authoring experience updates into a separate package</li>
  <li>Use ACS Commons tools and check them before you build new components.</li>
  <li>When using components from frameworks consider the impact on authoring experience, different frameworks have different authoring possibilities, with some making Authoring very Front End heavy without enabling Authors.</li>
</ol>

<p>This is a non-exhaustive list, but it should be a good start starting point.</p>

<p>As always, we welcome contributions this list, let us know by leaving a comment or better yet raise an issue in the repo.</p>

<p>Share this on your favourite network if you find this useful.</p>]]></content><author><name>Max Barrass</name><email>max@aem.design</email><uri>http://maxbarrass.com</uri></author><category term="blog" /><category term="devops" /><category term="aem" /><category term="docker" /><category term="knowledge" /><category term="sharing" /><category term="multi-tenant" /><category term="framework" /><summary type="html"><![CDATA[Notes to get you started creating a Multi-Tenant Environments on AEM]]></summary></entry></feed>